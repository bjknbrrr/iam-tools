Version: "2012-10-17"
Statement:
  # Restrict CloudTrail Permissions
  - Effect: Deny
    Action:
      - "cloudtrail:StopLogging"
      - "cloudtrail:DeleteTrail"
    Resource: "*"
    Condition:
      StringNotEquals:
        "aws:RequestTag/Environment": "Admin"

  # Allow S3 Access to a Specific Bucket (Restricted)
  - Effect: Allow
    Action:
      - "s3:PutObject"
      - "s3:GetObject"
    Resource: "arn:aws:s3:::cloudtrail-logs-bucket/*"
    Condition:
      StringEquals:
        "s3:x-amz-acl": "bucket-owner-full-control"

  # Restrict Role Creation and Policy Attachment
  - Effect: Deny
    Action:
      - "iam:CreateRole"
      - "iam:AttachRolePolicy"
    Resource: "*"
    Condition:
      StringEqualsIfExists:
        "aws:RequestedRegion": "us-west-1"

  # Limit EC2 Instance and Volume Management
  - Effect: Allow
    Action:
      - "ec2:RunInstances"
      - "ec2:TerminateInstances"
    Resource:
      - "arn:aws:ec2:region:account-id:instance/specific-instance-id"
      - "arn:aws:ec2:region:account-id:volume/specific-volume-id"
    Condition:
      StringEquals:
        "aws:RequestTag/Owner": "DevOps"
